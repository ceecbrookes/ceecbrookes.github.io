"use strict";function PersonalController(a,b){var c=this;(new Date).getFullYear();c.isLoading=!1,c.options={},c.test="testing 123",c.inputs={knownAs:{key:"KNOWN_AS",title:"Known As"},sex:{key:"SEX",title:"Sex"},gender:{key:"GENDER",title:"Has your gender changed from that which you were assigned at birth?",options:[{description:"Yes",code:1},{description:"No",code:0},{description:"Don't wish to answer",code:2}]},care:{key:"CHILD_CARE",title:"Do you have any care commitments that may affect your timetable?",options:[{description:"Yes",code:"Y"},{description:"No",code:""}]},previousEducation:{key:"PREVIOUS_EDUCATION",title:"Previous Education"},parentalEducation:{key:"PARENTAL_EDUCATION",title:"Do any of your parents of guardians have any higher education qualifications?"},yearLeftSchool:{key:"EXSC_YEAR_LEFT",title:"In what year did you leave school?"},occupationalBackground:{key:"OCCUPATIONAL_BACKGROUND",title:"Occupation",hint1:"Please give the occupation of your parent, step-parent or guardian who earns the most. If he or she is retired or unemployed, give their most recent occupation."},domicile:{key:"DOMICILE_CODE",title:"Domicile",options:{}},nationality:{key:"NATIONALITY_CODE",title:"Nationality"},disability:{key:"DISABLED",title:"Disability"},disabilityAllowance:{key:"REG_DISABLED",title:"Do you receive student disability allowance?"},ethnicOrigin:{key:"ETHNIC_ORIGIN",title:"Ethnic Origin"},vehicleReg:{key:"VEHICLE_REG",title:"Vehicle registration number"},mobileNumber:{key:"MOBILE_PHONE_NUMBER",title:"Mobile number"},emailAddress:{key:"EMAIL_ADDRESS",title:"Email address"},accommType:{key:"HESA_ACCOM_TYPE",title:"Term-time accommodation type"}},b.loadEnum("PEOPLE.PREVIOUS_EDUCATION","previousEducation",c.inputs),b.loadEnum("PEOPLE.PARENTAL_EDUCATION","parentalEducation",c.inputs),b.loadEnum("PEOPLE.SEX","sex",c.inputs),b.loadEnum("PEOPLE.HESA_ACCOM_TYPE","accommType",c.inputs),a.get("http://dmis.brookes.ac.uk/dsms/enrolment_api.countries").then(function(a){c.inputs.domicile.options.countries=a.data,c.inputs.nationality.options=a.data},function(a){console.log(a.status)}),a.get("http://dmis.brookes.ac.uk/dsms/enrolment_api.uk_counties").then(function(a){c.inputs.domicile.options.uk_counties=a.data},function(a){console.log(a.status)})}function AddressController(a,b){var c=this;c.addressData={},c.inputs={home:{street1:{title:"Street 1",key:"street1"},street2:{title:"Street 2",key:"street2"},state:{title:"County / State",key:"state"},country:{title:"Country",key:"country"},postcode:{title:"Postcode",key:"postcode"}},local:{street1:{title:"Street 1",key:"street1"},street2:{title:"Street 2",key:"street2"},state:{title:"County / State",key:"state"},country:{title:"Country",key:"country"},postcode:{title:"Postcode",key:"postcode"}}}}function QualificationsController(a,b,c,d){function e(a,b){a.hide=function(){b.hide()},a.cancel=function(){b.cancel()},a.add=function(a){a.deletable=!0,b.hide(a)}}var f=this;f.selected=[],f.options={autoSelect:!0,boundaryLinks:!1,largeEditDialog:!1,pageSelector:!1,rowSelection:!0},f.logItem=function(a){console.log(a.name,"was selected")},f.logOrder=function(a){console.log("order: ",a)},f.inputs={},f.qualifications=[{levelSubject:"A Level Mathematics",grade:"A",date:new Date(2015,7,1)},{levelSubject:"A Level English",grade:"Ungraded",date:new Date(2015,7,1)},{levelSubject:"A Level Geography",grade:"A",date:new Date(2015,7,1)},{levelSubject:"GCSE French",grade:"B",date:new Date(2013,7,1)}],f.showAddQualification=function(a){b.show({controller:e,targetEvent:a,templateUrl:"views/addQualification.html",clickOutsideToClose:!0}).then(function(a){f.qualifications.push(a)})},e.$inject=["$scope","$mdDialog"],f.deleteSelected=function(){f.qualifications=f.qualifications.filter(function(a){return-1===f.selected.indexOf(a)}),f.selected=[]}}var menu=[{label:"Personal",location:"personal"},{label:"Address",location:"address"},{label:"Qualifications",location:"qualifications"}];angular.module("enrolmentApp",["ngMaterial","ngMessages","ngRoute","md.data.table"]).run(["$rootScope",function(a){var b="[a-zA-Z ,.'-]*";a.Regex={Name:RegExp("^"+b+"$"),NameValidChars:b},a.Menu=menu}]).config(["$mdThemingProvider","$locationProvider","$routeProvider",function(a,b,c){a.definePalette("brookesLime",{50:"#f8fdbc",100:"#f0fb72",200:"#eaf93b",300:"#d5e607",400:"#b9c906",500:"#9eab05",600:"#828d04",700:"#676f03",800:"#4c5202",900:"#303402",A100:"#f8fdbc",A200:"#f0fb72",A400:"#b9c906",A700:"#676f03",contrastDefaultColor:"light",contrastDarkColors:"50 100 200 300 A100 A200"}),a.theme("default").primaryPalette("brookesLime"),b.hashPrefix("!"),b.html5Mode(!1);for(var d in menu){var e=menu[d];c.when("/"+e.location,{templateUrl:"views/"+e.location+".html",controller:e.location+"Controller",controllerAs:"vm"})}c.otherwise({redirectTo:"/personal"})}]).directive("capitalize",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){function e(a){function b(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}if(-1!==a.indexOf(" ")){var c,d;for(a=a.toLowerCase(),c=a.split(" "),d=0;d<c.length;d++)c[d]=b(c[d]);return c.toString().replace(/,/g," ")}return a=a.toLowerCase(),b(a)}function f(a){return(a||"").toUpperCase()}function g(a){return e(a||"")}d.$parsers.push(f),d.$formatters.push(g)}}}).directive("add2k",function(){var a=(new Date).getFullYear()%100;return{restrict:"A",require:"ngModel",link:function(b,c,d,e){function f(a){return a}function g(b){return a+10>=b%100?b+2e3:b+1900}e.$parsers.push(f),e.$formatters.push(g)}}}).service("Store",["$http",function(a){return{personalPromise:function(b){return a.get("http://dmis.brookes.ac.uk/dsms/enrolment_api.personal?per_id="+b)},loadEnum:function(b,c,d){a.get("http://dmis.brookes.ac.uk/dsms/enrolment_api.cg_ref_json?rv_domain="+b).then(function(a){d[c].options=Object.keys(a.data).map(function(b){return{code:b,description:a.data[b]}})},function(a){console.log(a.status)})}}}]).controller("mainCtrl",["$rootScope","$scope","$location","$mdToast","$document",function(a,b,c,d,e){b.changeView=function(a){c.path(a)},b.next=function(){b.selectedIndex++},b.$watch("selectedIndex",function(){void 0!==b.selectedIndex&&(console.log(b.selectedIndex),console.log(a.Menu[b.selectedIndex].location),b.changeView(a.Menu[b.selectedIndex].location))});var f=this;f.percentComplete=10,f.showSimpleToast=function(){d.show(d.simple().textContent("Saved progress... you may return to this page and continue your enrolment later").position("fit").hideDelay(3e3))}}]).config(["$logProvider",function(a){a.debugEnabled(!0)}]).filter("prettyJSON",function(){function a(a){return JSON?JSON.stringify(a,null,"  "):"your browser doesnt support JSON so cant pretty print"}return a}).filter("isEmpty",function(){return function(a){return angular.equals({},a)}}).filter("remove",function(){return function(a,b){return a.replace(new RegExp(b,"g"),"")}}),PersonalController.$inject=["$http","Store"],angular.module("enrolmentApp").controller("personalController",PersonalController),AddressController.$inject=["$http","Store"],angular.module("enrolmentApp").controller("addressController",AddressController),QualificationsController.$inject=["$scope","$mdDialog","$http","Store"],angular.module("enrolmentApp").controller("qualificationsController",QualificationsController),angular.module("enrolmentApp").run(["$templateCache",function(a){a.put("views/addQualification.html",'<md-dialog ng-cloak style="width:300px"> <form name="qualificationForm"> <md-toolbar> <div class="md-toolbar-tools"> <h3> <span>Add Qualification</span> </h3> </div> </md-toolbar> <div layout-margin> <div> <md-input-container class="md-block"> <label>Level / Subject</label> <input ng-model="newQualification.levelSubject" capitalize type="text" required> </md-input-container> </div> <div> <md-input-container class="md-block"> <label>Grade</label> <input ng-model="newQualification.grade" type="text" required> </md-input-container> </div> <div layout="row" layout-align="center"> <div flex="10"></div> <div flex="80"> <md-datepicker ng-model="newQualification.date" md-placeholder="Date" style="background-color:rgba(0, 0, 0, 0.0)" required></md-datepicker> </div> <div flex="10"></div> </div> </div> <div layout="column" layout-align="end center" layout-wrap> <div flex="5"></div> <div layout="row"> <md-button ng-click="cancel()" class="md-primary">Cancel</md-button> <md-button ng-disabled="qualificationForm.$invalid" ng-click="add(newQualification)" class="md-primary"><b>Add</b></md-button> </div> </div> </form> </md-dialog>'),a.put("views/address.html",'<form name="addressForm" ng-init="flex_val = 30" ng-if="!vm.isLoading" layout="column" layout-align="space-around stretch" layout-margin> <span class="md-subhead">Home Address</span> <div> <div flex> <md-input-container ng-init="street1 = vm.inputs.home[\'street1\']" class="md-block"> <label>{{street1.title}}</label> <input name="street1" ng-model="vm.addressData[street1.key]" capitalize type="text" required> <div ng-messages="addressForm.street1.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.street1.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div flex> <md-input-container ng-init="street2 = vm.inputs.home[\'street2\']" class="md-block"> <label>{{street2.title}}</label> <input name="street2" ng-model="vm.addressData[street2.key]" capitalize type="text"> <div ng-messages="addressForm.street2.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.street1.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div flex> <md-input-container ng-init="state = vm.inputs.home[\'state\']" class="md-block"> <label>{{state.title}}</label> <input name="state" ng-model="vm.addressData[state.key]" capitalize type="text"> <div ng-messages="addressForm.state.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.state.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div flex> <md-input-container ng-init="country = vm.inputs.home[\'country\']" class="md-block"> <label>{{country.title}}</label> <input name="country" ng-model="vm.addressData[country.key]" capitalize type="text"> <div ng-messages="addressForm.country.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.country.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div flex> <md-input-container ng-init="postcode = vm.inputs.home[\'postcode\']" class="md-block"> <label>{{postcode.title}}</label> <input name="postcode" ng-model="vm.addressData[postcode.key]" capitalize type="text"> <div ng-messages="addressForm.postcode.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.postcode.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> </div> <div style="background: rgb(240,240,240); margin: 40px; height: 4px"></div> <span class="md-subhead">Term-time Address</span> <div> <div flex> <md-input-container ng-init="street1 = vm.inputs.local[\'street1\']" class="md-block"> <label>{{street1.title}}</label> <input name="street1" ng-model="vm.addressData[street1.key]" capitalize type="text" required> <div ng-messages="addressForm.street1.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.street1.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div flex> <md-input-container ng-init="street2 = vm.inputs.local[\'street2\']" class="md-block"> <label>{{street2.title}}</label> <input name="street2" ng-model="vm.addressData[street2.key]" capitalize type="text"> <div ng-messages="addressForm.street2.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.street1.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div flex> <md-input-container ng-init="state = vm.inputs.local[\'state\']" class="md-block"> <label>{{state.title}}</label> <input name="state" ng-model="vm.addressData[state.key]" capitalize type="text"> <div ng-messages="addressForm.state.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.state.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div flex> <md-input-container ng-init="country = vm.inputs.local[\'country\']" class="md-block"> <label>{{country.title}}</label> <input name="country" ng-model="vm.addressData[country.key]" capitalize type="text"> <div ng-messages="addressForm.country.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.country.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div flex> <md-input-container ng-init="postcode = vm.inputs.local[\'postcode\']" class="md-block"> <label>{{postcode.title}}</label> <input name="postcode" ng-model="vm.addressData[postcode.key]" capitalize type="text"> <div ng-messages="addressForm.postcode.$error" role="alert" md-auto-hide="false"> <div ng-if="addressForm.postcode.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div flex layout="row" layout-align="center"> <md-button ng-click="next()" class="md-raised md-primary">Next</md-button> </div> </div> </form>'),a.put("views/fees.html","<div> Address html </div>"),a.put("views/payment.html","<div> Address html </div>"),a.put("views/personal.html",'<!-- Personal.html --> <md-progress-circular ng-if="vm.isLoading" md-mode="indeterminate"></md-progress-circular> <form name="personalForm" ng-if="!vm.isLoading" layout="column" layout-align="space-around stretch"> <div> <div> <md-input-container class="md-block" flex-gt-sm> <label>Email</label> <input name="email" ng-model="user.email" required minlength="10" maxlength="100" ng-pattern="/^.+@.+\\..+$/"> <div class="hint" ng-show="showHints">How can we reach you?</div> <div ng-messages="personalForm.email.$error" ng-hide="showHints"> <div ng-if="personalForm.email.$touched" ng-message-exp="[\'required\', \'minlength\', \'maxlength\', \'pattern\']"> Please enter a valid e-mail address. </div> </div> </md-input-container> </div> <div> <md-input-container ng-init="knownAs = vm.inputs[\'knownAs\']" class="md-block"> <label>{{knownAs.title}}</label> <input name="knownAs" ng-model="vm.personalData[knownAs.key]" capitalize ng-pattern="Regex.Name" type="text" required> <div ng-messages="personalForm.knownAs.$error" role="alert" md-auto-hide="false"> <div ng-if="personalForm.knownAs.$touched" ng-message="required">* Required *</div> <div ng-if="personalForm.knownAs.$touched" ng-message="pattern">Please remove invalid characters: {{personalForm.knownAs.$viewValue | remove : Regex.NameValidChars}}</div> </div> </md-input-container> </div> <div> <md-input-container ng-init="sex = vm.inputs[\'sex\']" class="md-block"> <label>{{sex.title}}</label> <md-select ng-model="vm.personalData[sex.key]"> <md-option ng-repeat="sex in sex.options" value="{{sex.code}}">{{sex.description}}</md-option> </md-select> </md-input-container> </div> <div>&nbsp</div> <div> <md-input-container ng-init="gender = vm.inputs[\'gender\']" class="md-block"> <label>{{gender.title}}</label> <md-select ng-model="vm.personalData[gender.key]"> <md-option ng-repeat="gender in gender.options" value="{{gender.code}}">{{gender.description}}</md-option> </md-select> </md-input-container> </div> <div>&nbsp</div> <div> <md-input-container ng-init="care = vm.inputs[\'care\']" class="md-block"> <label>{{care.title}}</label> <md-select ng-model="vm.personalData[care.key]"> <md-option ng-repeat="care in care.options" value="{{care.code}}">{{care.description}}</md-option> </md-select> </md-input-container> </div> <div>&nbsp</div> <!-- <div style="background: rgb(240,240,240); margin: 50px; height: 4px;" flex="100"></div> --> <div> <md-input-container ng-init="previousEducation = vm.inputs[\'previousEducation\']" class="md-block"> <label>{{previousEducation.title}}</label> <md-select md-on-open="loadPreviousEducation" ng-model="vm.personalData[previousEducation.key]"> <md-option ng-repeat="previousEducation in previousEducation.options" value="{{previousEducation.code}}">{{previousEducation.description}}</md-option> </md-select> </md-input-container> </div> <div>&nbsp</div> <div> <md-input-container ng-init="parentalEducation = vm.inputs[\'parentalEducation\']" class="md-block"> <label>{{parentalEducation.title}}</label> <md-select ng-model="vm.personalData[parentalEducation.key]"> <md-option ng-repeat="parentalEducation in parentalEducation.options" value="{{parentalEducation.code}}">{{parentalEducation.description}}</md-option> </md-select> </md-input-container> </div> <div>&nbsp</div> <div> <md-input-container ng-init="yearLeftSchool = vm.inputs[\'yearLeftSchool\']" class="md-block"> <label>{{yearLeftSchool.title}}</label> <input name="yearLeftSchool" ng-model="vm.personalData[yearLeftSchool.key]" add2k type="number" step="1" required> <div ng-messages="personalForm.yearLeftSchool.$error" role="alert" md-auto-hide="false"> <div ng-if="personalForm.knownAs.$touched" ng-message="required">* Required *</div> <div ng-if="personalForm.knownAs.$touched" ng-message="min">min</div> <div ng-if="personalForm.knownAs.$touched" ng-message="max">max</div> </div> </md-input-container> </div> <div> <md-input-container ng-init="occupationalBackground = vm.inputs[\'occupationalBackground\']" class="md-block"> <label>{{occupationalBackground.title}}</label> <input name="occupationalBackground" ng-model="vm.personalData[occupationalBackground.key]" capitalize type="text" required> <div ng-messages="personalForm.occupationalBackground.$error" role="alert" md-auto-hide="false"> <div ng-if="personalForm.knownAs.$touched" ng-message="required">* Required *</div> </div> </md-input-container> </div> <div> <md-input-container ng-init="domicile = vm.inputs[\'domicile\']" class="md-block"> <label>{{domicile.title}}</label> <md-select ng-model="vm.personalData[domicile.key]"> <md-option ng-if="false" ng-repeat="country in domicile.options.countries" value="{{country.CODE}}">{{country.DESCRIPTION}}</md-option> <md-option ng-if="true" ng-repeat="uk_county in domicile.options.uk_counties" value="{{uk_county.CODE}}">{{uk_county.DESCRIPTION}}</md-option> </md-select> </md-input-container> </div> <div>&nbsp</div> <div> <md-input-container ng-init="nationality = vm.inputs[\'nationality\']" class="md-block"> <label>{{nationality.title}}</label> <md-select ng-model="vm.personalData[nationality.key]"> <md-option ng-repeat="nationality in nationality.options" value="{{nationality.CODE}}">{{nationality.NATIONALITY_DESCRIPTION}}</md-option> </md-select> </md-input-container> </div> <div>&nbsp</div> <div> <md-input-container ng-init="accommType = vm.inputs[\'accommType\']" class="md-block"> <label>{{accommType.title}}</label> <md-select ng-model="vm.personalData[accommType.key]"> <md-option ng-repeat="accommType in accommType.options" value="{{accommType.code}}">{{accommType.description}}</md-option> </md-select> </md-input-container> </div> <div layout="row" layout-align="center"> <md-button ng-click="next()" class="md-raised md-primary">Next</md-button> </div> <!--   <pre class="green">{{vm.personalData | prettyJSON}}</pre>\n  <pre class="green">{{vm.inputs | prettyJSON}}</pre> --> </div> </form>'),a.put("views/qualifications.html",'<md-card> <md-toolbar class="md-table-toolbar alternate"> <div class="md-toolbar-tools"> <span>My Qualifications</span> <div flex></div> <md-button ng-show="vm.selected.length" class="md-raised md-warn" ng-click="vm.deleteSelected($event)" aria-label="Eat cake">Delete Selected</md-button> <md-button ng-hide="vm.selected.length" class="md-fab md-mini" ng-click="vm.showAddQualification($event)" aria-label="Eat cake"> <md-icon md-svg-src="images/icons/ic_add_white_48px.svg"></md-icon> </md-button> </div> </md-toolbar> <md-table-container> <table md-table md-row-select="true" ng-model="vm.selected" md-progress="vm.promise"> <thead md-head md-order="query.order" md-on-reorder="vm.logOrder"> <tr md-row> <th md-column><span>Level / Subject</span></th> <th md-column><span>Grade</span></th> <th md-column><span>Date</span></th> </tr> </thead> <tbody md-body> <tr md-row md-select="qualification" md-on-select="vm.logItem" ng-disabled="!qualification.deletable" md-auto-select="true" ng-repeat="qualification in vm.qualifications"> <td md-cell>{{qualification.levelSubject}}</td> <td md-cell>{{qualification.grade}}</td> <td md-cell>{{qualification.date | date}}</td> </tr> </tbody> </table> </md-table-container> </md-card>')}]);